<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Resources â€” New Horizon</title>
  <link rel="stylesheet" href="../css/base.css">
  <link rel="stylesheet" href="../css/resources.css">
</head>
<body class="resources-body">
  <header data-partial="header"></header>

  <main>
    <section class="resources-hero">
      <h1>Resources</h1>
      <p>Explore helpful mental wellness links and materials.</p>
    </section>

    <section class="resources-section">
      <div id="resources-container">
        <p style="text-align: center; padding: 2rem;">Loading resources...</p>
      </div>
    </section>

    <div class="resources-back">
      <a class="btn" href="/group8/frontend/index.html">Back to Home</a>
    </div>
  </main>

  <footer data-partial="footer"></footer>
  <script src="../js/config.js"></script>
  <script src="../js/app.js"></script>
  <script src="../js/api.js"></script>
  <script>
    document.addEventListener('DOMContentLoaded', loadResources);

    async function loadResources() {
      const container = document.getElementById('resources-container');

      try {
        const data = await API.resources.getAll();
        const resources = data.resources || [];

        if (resources.length === 0) {
          container.innerHTML = '<p style="text-align: center; padding: 2rem;">No resources available yet.</p>';
          return;
        }

        container.innerHTML = `
          <ul class="resources-list">
            ${resources.map(r => `
              <li class="resource-item">
                <h3>${escapeHtml(r.title)}</h3>
                ${r.description ? `<p>${escapeHtml(r.description)}</p>` : ''}
                ${r.resource_url ? `<a href="${r.resource_url}" target="_blank" class="resource-link">View Resource</a>` : ''}
              </li>
            `).join('')}
          </ul>
        `;
      } catch (error) {
        console.error('Error loading resources:', error);
        container.innerHTML = '<p style="text-align: center; padding: 2rem; color: #c0392b;">Failed to load resources.</p>';
      }
    }

    function escapeHtml(text) {
      if (!text) return '';
      const div = document.createElement('div');
      div.textContent = text;
      return div.innerHTML;
    }
  </script>
</body>
</html>
